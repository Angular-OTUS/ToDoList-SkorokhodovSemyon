<div class="todo-card">
  <h1 class="todo-card__title">Todo List</h1>

  <div class="todo-card__main-content">

    <div class="todo-card__list-wrapper">
      @if (!isLoading()) {
        @if (taskList().length > 0) {
          <mat-form-field appearance="outline" class="add-form__input-field">
            <mat-label>Фильтр по статусу</mat-label>
            <mat-select
              [ngModel]="statusFilter()"
              (ngModelChange)="statusFilter.set($event)"
            >
              <mat-option [value]="null">Все</mat-option>
              <mat-option [value]="'InProgress'">В процессе</mat-option>
              <mat-option [value]="'Completed'">Выполнены</mat-option>
            </mat-select>
          </mat-form-field>
        }
        <ul class="task-list">
          @for (task of filteredTaskList(); track task.id) {
            <app-to-do-list-item
              class="task-list__item"
              [item]="task"
              [class.selected]="selectedTask()?.id === task.id"
              (select)="selectTaskHandler($event)"
              (remove)="removeTaskHandler($event)"
              (update)="updateTaskHandler($event)"
            >
            </app-to-do-list-item>
          } @empty {
            <p class="task-list__empty-message">Список задач пуст</p>
          }
        </ul>
      } @else {
        <div class="spinner-container">
          <app-spinner></app-spinner>
        </div>
      }
      <div class="add-form">
        <mat-form-field class="add-form__input-field" appearance="outline">
          <mat-label>Название задачи</mat-label>
          <input
            matInput
            type="text"
            placeholder="Название задачи"
            [ngModel]="newTaskTitle()"
            (ngModelChange)="newTaskTitle.set($event)"
          />
        </mat-form-field>

        <mat-form-field class="add-form__input-field" appearance="outline">
          <mat-label>Описание задачи</mat-label>
          <textarea
            matInput
            rows="4"
            placeholder="Описание задачи"
            [ngModel]="newTaskDescription()"
            (ngModelChange)="newTaskDescription.set($event)"
          ></textarea>
        </mat-form-field>
        <app-button
          appTooltip="Добавить задачу"
          (click)="addTaskHandler()"
          [disabled]="!newTaskTitle().trim() || !newTaskDescription().trim()"
          [typeButton]="'add'"
        >
          Добавить
        </app-button>
      </div>
    </div>

    @if (selectedTask() !== null) {
      <div class="todo-card__description-wrapper">
        <div class="description-content">
          <h2>Описание задачи</h2>
          <p class="description-content__text">
            {{ selectedTask()!.description }}
          </p>
        </div>
      </div>
    }
  </div>
</div>
